%!PS-Adobe-2.0 EPSF-1.2
%%Creator: idraw
%%DocumentFonts: Helvetica Helvetica-Bold
%%BoundingBox: 95 10 505 130
%%EndComments

0.6 0.6 scale
900 0 translate
90 rotate

/Times-Roman findfont
8 scalefont setfont

% Plot:: sring->(string list)->((index # time # pattern) list)->scale_sep->PS
/Plot {
    gsave
    0.0 750.0 translate
    -90.0 rotate
    /tick_dist exch def
    /entries exch def
    /nodear exch def
    /comment exch def

    /timepoints [ entries {aload pop pop exch pop} forall ] def
    /max -1 def
    /min 999999 def
    timepoints {
	/cur exch def
	max cur lt {/max cur def} if
	cur min lt {/min cur def} if } forall
    /duration max min sub def
    /scale_factor 600 duration div def

    /cnt nodear length def
    /sep 500 cnt div dup 30 ge {pop 30} if def
    /wht sep 2 mul 3 div def
    /space sep wht sub def

    /timeax  40 def % Start y-coordinate of time axes
    /bottomwf 50 def % Start y-coordinate for waveforms
    /startwf 50 def % Start x-coordinate for waveforms
    /Mwht -1 wht mul def

    % Drawing patterns
    /UD { 0 wht rlineto 0 Mwht rmoveto } def
    /B  { UD currentpoint pop startwf sub sub } def

    /none  {
	B dup 0 rmoveto gsave
	0.95 setgray 0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto closepath
	fill grestore UD} def
    /H  {
	B 0 wht rlineto 0 rlineto 0 Mwht rlineto UD
	} def
    /L  {
	B 0 rlineto UD
	} def
    /X  {
	B dup 0 rmoveto gsave
	0.7 setgray 0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto closepath fill
	grestore UD} def
    /illegal {
	B dup 0 rmoveto gsave
	0.0 setgray 0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto closepath fill
	grestore UD} def
    /LH {
	B dup 0 rlineto gsave
	0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto closepath stroke
	grestore UD} def
    /LX {
	B dup 0 rlineto gsave 
	0.7 setgray 0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto closepath fill
	grestore UD} def
    /XH {
	B dup 0 wht rmoveto 0 rlineto 0 Mwht rmoveto gsave 
	0.7 setgray 0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto closepath fill
	grestore UD} def
    /LXH {
	B dup dup dup 0 rlineto 0 wht rmoveto -1 mul 0 rlineto Mwht rmoveto
	gsave 0.7 setgray 0 wht rlineto -1 mul 0 rlineto 0 Mwht rlineto
	closepath fill
	grestore UD} def


    /artime [ cnt {startwf} repeat ] def
    /curpattern [ cnt {{none}} repeat ] def

    /wf { % idx newtime newproc  wf  -
	    /newproc exch def
	    /newtime exch def
	    /idx exch def
	    % 
	    /old_time artime idx get def
	    /old_value idx sep mul bottomwf add def
	    old_time old_value moveto
	    newtime min sub scale_factor mul curpattern idx get
	    % newtime oldproc
	    exec
	    artime idx currentpoint
	    % artime idx new_time new_value
	    pop
	    % artime idx new_time
	    put
	    curpattern idx newproc put
	    stroke
    } def


    /TimeScale { % limit incr TimeScale -
	    /Incr exch def
	    /Limit exch def
	    /sI Incr scale_factor mul def
	    /smalltick
		{sI 0 rmoveto pop 0 2 rmoveto 0 -4 rlineto 0 2 rmoveto} def
	    /mediumtick {sI 0 rmoveto 0 4 rmoveto 0 -8 rlineto 0 4 rmoveto} def
	    /bigtick{sI 0 rmoveto 0 6 rmoveto 0 -12 rlineto 0 6 rmoveto} def

	    % Draw tick marks
	    startwf timeax moveto
	    0 6 rmoveto 0 -12 rlineto 0 6 rmoveto
	    /Cnt Limit min sub Incr 10 mul div ceiling def
	    1 1 Cnt {
		1 sub 10 Incr mul mul min add
		gsave
		    2 -10 rmoveto 10 string cvs show
		grestore
		1 1 4 {smalltick} for
		mediumtick
		1 1 4 {smalltick} for
		bigtick
		gsave
		    0.4 setlinewidth
		    0.5 setgray
		    currentpoint pop bottomwf lineto
		    0 1 cnt 1 sub {sep mul bottomwf add wht add
			     currentpoint pop exch moveto 0 space rlineto} for
		    stroke
		grestore} for
	    stroke

	    % Draw time axle
	    Cnt 10 Incr mul mul scale_factor mul
	    % scale_factor*limit
	    startwf timeax moveto
	    % scale_factor*limit
	    0 rlineto
	    gsave
	    20 0 rlineto currentpoint stroke moveto 5 0 rmoveto
	    -10 3 rmoveto 10 -3 rlineto -10 -3 rlineto fill grestore
	    stroke
    } def

    max 1.0 mul tick_dist TimeScale

    entries {aload pop wf} forall

    % Print out node names
    0 1 cnt 1 sub
       {dup nodear exch get exch sep mul bottomwf add 15 exch moveto show} for


    % Print comment
    startwf timeax 20 sub moveto comment show

    showpage
    grestore
} def

%%EndProlog
() [
 (ck)
 (y[3])
 (y[2])
 (y[1])
 (y[0])
] [
[4 0 {{X}}]
[3 0 {{X}}]
[2 0 {{X}}]
[1 0 {{X}}]
[0 0 {{X}}]
[0 0 {{L}}]
[3 11 {{H}}]
[2 12 {{H}}]
[1 13 {{H}}]
[0 50 {{H}}]
[0 100 {{L}}]
[1 106 {{X}}]
[2 106 {{X}}]
[3 106 {{X}}]
[0 150 {{H}}]
[4 200 {{none}}]
[3 200 {{none}}]
[2 200 {{none}}]
[1 200 {{none}}]
[0 200 {{none}}]
] 5 Plot
%%Trailer

